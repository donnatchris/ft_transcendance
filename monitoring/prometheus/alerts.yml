groups:
- name: transcendance_alerts
  rules:
  # Alertes bas√©es sur les healthchecks
  - alert: GameServiceHealthcheckFailed
    expr: probe_success{instance="https://game:3002/health"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "üéÆ Service Game healthcheck failed!"
      description: "Le healthcheck du service Game a √©chou√© depuis 30 secondes."

  - alert: PublicServiceHealthcheckFailed
    expr: probe_success{instance="https://public:3000/health"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "üåê Service Public healthcheck failed!"
      description: "Le healthcheck du service Public a √©chou√© depuis 30 secondes."

  - alert: UserServiceHealthcheckFailed
    expr: probe_success{instance="https://user:3001/health"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "üë§ Service User healthcheck failed!"
      description: "Le healthcheck du service User a √©chou√© depuis 30 secondes."

  - alert: GateServiceHealthcheckFailed
    expr: probe_success{instance="https://gate:3005/health"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "üö™ Service Gate healthcheck failed!"
      description: "Le healthcheck du service Gate a √©chou√© depuis 30 secondes."

  - alert: IAServiceHealthcheckFailed
    expr: probe_success{instance="https://ia:3003/health"} == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "ü§ñ Service IA healthcheck failed!"
      description: "Le healthcheck du service IA a √©chou√© depuis 30 secondes."

  - alert: KibanaHealthcheckFailed
    expr: probe_success{instance="http://kibana:5601/kibana/api/status"} == 0
    for: 60s
    labels:
      severity: warning
    annotations:
      summary: "üìä Kibana healthcheck failed!"
      description: "Le healthcheck de Kibana a √©chou√© depuis 1 minute."

  - alert: LogstashHealthcheckFailed
    expr: probe_success{instance="http://logstash:9600/_node/stats"} == 0
    for: 60s
    labels:
      severity: warning
    annotations:
      summary: "üìù Logstash healthcheck failed!"
      description: "Le healthcheck de Logstash a √©chou√© depuis 1 minute."

  # Alertes pour les dur√©es de r√©ponse des healthchecks
  - alert: SlowHealthcheckResponse
    expr: probe_duration_seconds > 5
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "Slow healthcheck response for {{ $labels.instance }}"
      description: "Le healthcheck de {{ $labels.instance }} prend plus de 5 secondes √† r√©pondre."
